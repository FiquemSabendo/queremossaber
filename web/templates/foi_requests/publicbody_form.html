{% extends "base.html" %}

{% block content %}
{% load widget_tweaks %}

{% load static %}

<div>
  <h2>Cadastrar órgão público</h2>

  <form
    action="{% url 'publicbody_new' %}"
    method="post">
    {% csrf_token %}

    <div class="form-field">
      {{ form.name.errors }}

      <label for="{{ form.name.id_for_label }}">
        Nome
      </label>
      {% render_field form.name placeholder="Qual o nome do órgão público?" %}
      <small>
        Antes de cadastrar um novo órgão, por favor confira se ele já não existe <a href="{% url 'foi_request_new' %}">aqui</a>.
      </small>
    </div>

    <div class="form-field">
      {{ form.name.errors }}

      <label for="{{ form.level.id_for_label }}">
        Esfera
      </label>
      {% render_field form.level %}
    </div>

    <div class="form-field">
      {{ form.uf.errors }}

      <label for="{{ form.uf.id_for_label }}">
        Estado
      </label>
      {% render_field form.uf %}
    </div>

    <div class="form-field">
      {{ form.municipality.errors }}

      <label for="{{ form.municipality.id_for_label }}">
        Cidade
      </label>
      {% render_field form.municipality %}
    </div>

    <div class="form-field">
      {{ esic_form.url.errors }}
      <label for="{{ form.esic_url.id_for_label }}">
        URL do Sistema de Informação ao Cidadão
      </label>
      {% render_field esic_form.url placeholder="Qual o endereço da página onde podemos enviar pedidos? (ex.: http://exemplo.gov.br/esic)" %}
    </div>

    <div class="form-submit">
      <button type="submit">
        Cadastrar
      </button>
      ou
      <a class="link-dimmed" href="{% url 'foi_request_new' %}">cancelar</a>
    </div>
  </form>
</div>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/jquery.min.js' %}"></script>
<script>
  $('#id_level').on('change', function(){
    let municipality = $('#id_municipality');
    let uf = $('#id_uf');

    if(this.value === 'State'){
      municipality.prop('disabled', true);
      uf.prop('disabled', false);
    }else if(this.value === 'Federal'){
      municipality.prop('disabled', true);
      uf.prop('disabled', true);
    }else{
      municipality.prop('disabled', false);
      uf.prop('disabled', false);
    }
  });
</script>
{% endblock %}